# cards_meta.py

import random

# Список всех доступных карт. Каждая карта = dict.
# Поля:
# - id: внутренний id для файла
# - name: имя карты
# - image: путь к картинке
# - upright / reversed: краткие ключевые смыслы
# - blurb: короткое описание в человеческом стиле

TAROT_CARDS = [
    {
        "id": "0_the_fool",
        "name": "The Fool",
        "image": "00_the_fool.jpg",
        "upright": ["новый старт", "спонтанность", "доверие миру"],
        "reversed": ["импульсивность", "наивность", "риск без плана"],
        "blurb": "Энергия начала. Шаг вперёд даже если страшно.",
    },
    {
        "id": "1_the_magician",
        "name": "The Magician",
        "image": "01_the_magician.jpg",
        "upright": ["сила воли", "фокус", "проявление идеи в реальность"],
        "reversed": ["манипуляция", "сомнение в себе", "распыление энергии"],
        "blurb": "Ты можешь превратить мысль в действие. Ресурсы уже есть.",
    },
    {
        "id": "2_the_high_priestess",
        "name": "The High Priestess",
        "image": "02_the_high_priestess.jpg",
        "upright": ["интуиция", "тишина", "секреты"],
        "reversed": ["подавленная интуиция", "самообман", "нерешительность"],
        "blurb": "Информация уже внутри тебя. Просто стань тише.",
    },
    {
        "id": "3_the_empress",
        "name": "The Empress",
        "image": "03_the_empress.jpg",
        "upright": ["забота", "изобилие", "тело и удовольствие"],
        "reversed": ["истощение", "самокритика", "передержка других"],
        "blurb": "Красота и тело требуют внимания, не спешки.",
    },
    {
        "id": "4_the_emperor",
        "name": "The Emperor",
        "image": "04_the_emperor.jpg",
        "upright": ["структура", "уверенность", "контроль"],
        "reversed": ["жесткость", "страх потери власти", "упрямство"],
        "blurb": "Власть не в силе, а в спокойствии и ясности границ.",
    },
    {
        "id": "5_the_hierophant",
        "name": "The Hierophant",
        "image": "05_the_hierophant.jpg",
        "upright": ["традиция", "обучение", "совет старшего"],
        "reversed": ["сомнение в авторитетах", "нестандартный путь"],
        "blurb": "Учение рядом, но слушай только то, что откликается в тебе.",
    },
    {
        "id": "6_the_lovers",
        "name": "The Lovers",
        "image": "06_the_lovers.jpg",
        "upright": ["любовь", "соединение", "выбор сердцем"],
        "reversed": ["страх близости", "сомнение в выборе"],
        "blurb": "Соединение приходит, когда ты не боишься быть собой.",
    },
    {
        "id": "7_the_chariot",
        "name": "The Chariot",
        "image": "07_the_chariot.jpg",
        "upright": ["движение", "контроль", "целеустремлённость"],
        "reversed": ["потеря направления", "перегорание", "хаос"],
        "blurb": "Не гони — управляй. Победа в том, чтобы чувствовать ритм.",
    },
    {
        "id": "8_strength",
        "name": "Strength",
        "image": "08_strength.jpg",
        "upright": ["мужество", "внутренняя сила", "терпение"],
        "reversed": ["сомнение в себе", "усталость", "внутренний критик"],
        "blurb": "Сила — это мягкость, которая не ломается под давлением.",
    },
    {
        "id": "9_the_hermit",
        "name": "The Hermit",
        "image": "09_the_hermit.jpg",
        "upright": ["самопознание", "тишина", "поиск смысла"],
        "reversed": ["изоляция", "потеря ориентира", "закрытость"],
        "blurb": "Пауза — не одиночество. Это момент слушать свет внутри.",
    },
    {
        "id": "10_wheel_of_fortune",
        "name": "Wheel of Fortune",
        "image": "10_wheel_of_fortune.jpg",
        "upright": ["цикл", "удача", "неожиданное в плюс"],
        "reversed": ["застревание", "чувство что тебя несёт", "хаос"],
        "blurb": "Колесо крутится. Это момент сдвига, не статики.",
    },
    {
        "id": "11_justice",
        "name": "Justice",
        "image": "11_justice.jpg",
        "upright": ["справедливость", "ясность", "равновесие"],
        "reversed": ["самообман", "несправедливость", "отрицание правды"],
        "blurb": "Посмотри на факты без эмоций — и правда станет очевидной.",
    },
    {
        "id": "12_the_hanged_man",
        "name": "The Hanged Man",
        "image": "12_the_hanged_man.jpg",
        "upright": ["новый взгляд", "принятие", "паузa"],
        "reversed": ["сопротивление", "жертва", "отказ отпустить"],
        "blurb": "Иногда рост требует остановки. Просто повисни в моменте.",
    },
    {
        "id": "13_death",
        "name": "Death",
        "image": "13_death.jpg",
        "upright": ["конец цикла", "трансформация", "очищение"],
        "reversed": ["страх перемен", "цепляние за старое"],
        "blurb": "Чтобы выросло новое, старое должно уйти. Это не конец, а переход.",
    },
    {
        "id": "14_temperance",
        "name": "Temperance",
        "image": "14_temperance.jpg",
        "upright": ["гармония", "баланс", "терпение"],
        "reversed": ["крайности", "нетерпение", "дисбаланс"],
        "blurb": "Смешай несмешиваемое — и найди золотую середину.",
    },
    {
        "id": "15_the_devil",
        "name": "The Devil",
        "image": "15_the_devil.jpg",
        "upright": ["искушение", "зависимость", "материальные желания"],
        "reversed": ["освобождение", "принятие теней"],
        "blurb": "Признай, что держит тебя — и перестанет держать.",
    },
    {
        "id": "16_the_tower",
        "name": "The Tower",
        "image": "16_the_tower.jpg",
        "upright": ["внезапное изменение", "разрушение иллюзий", "кризис"],
        "reversed": ["сопротивление переменам", "отрицание очевидного"],
        "blurb": "Разрушение — это очищение. Падает то, что мешало расти.",
    },
    {
        "id": "17_the_star",
        "name": "The Star",
        "image": "17_the_star.jpg",
        "upright": ["надежда", "вдохновение", "восстановление"],
        "reversed": ["сомнение", "потеря веры", "апатия"],
        "blurb": "После шторма всегда звёзды. Позволь себе верить снова.",
    },
    {
        "id": "18_the_moon",
        "name": "The Moon",
        "image": "18_the_moon.jpg",
        "upright": ["интуиция", "сны", "тайны"],
        "reversed": ["иллюзии", "страхи", "заблуждения"],
        "blurb": "Не всё ясно — и это нормально. Доверься чувствам, не логике.",
    },
    {
        "id": "19_the_sun",
        "name": "The Sun",
        "image": "19_the_sun.jpg",
        "upright": ["радость", "успех", "ясность"],
        "reversed": ["усталость", "временные тучи"],
        "blurb": "Свет есть всегда, даже если ты его не видишь прямо сейчас.",
    },
    {
        "id": "20_judgement",
        "name": "Judgement",
        "image": "20_judgement.jpg",
        "upright": ["пробуждение", "принятие решения", "новая жизнь"],
        "reversed": ["сомнение", "отказ слышать зов"],
        "blurb": "Прошлое зовёт к осознанию. Прими урок и сделай шаг вперёд.",
    },
    {
        "id": "21_the_world",
        "name": "The World",
        "image": "21_the_world.jpg",
        "upright": ["завершение", "уровень ап", "гармония"],
        "reversed": ["почти-конец но не до конца", "незакрытый гештальт"],
        "blurb": "Цикл подходит к концу. Тебя ждёт следующая версия тебя.",
    },
]


def pick_daily_cards(seed_str: str, n_cards: int = 3):
    """
    Детерминированно выбираем n_cards карт для заданного seed (обычно дата).
    Каждая карта может быть upright или reversed.
    Возвращаем список dict с добавленным полем "is_reversed".
    """
    rng = random.Random(seed_str)

    cards = rng.sample(TAROT_CARDS, n_cards)
    result = []
    for c in cards:
        reversed_flag = rng.random() < 0.5
        result.append({
            **c,
            "is_reversed": reversed_flag,
        })
    return result
